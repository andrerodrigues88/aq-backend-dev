<p align="center">
  <br>
  <div style="margin:auto; width: 220px">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 510.2 240.9" class="w-24"><g><g><path fill="#ABC45C" d="M320,67.1c0-35.8-29.1-64.8-64.8-64.8s-64.8,29.1-64.8,64.8c0,24.8,14.5,47.8,36.8,58.5c3.2,1.5,7,0.2,8.6-3
			c1.5-3.2,0.2-7-3-8.6c-17.9-8.6-29.5-27-29.5-46.9c0-28.7,23.3-52,52-52s52,23.3,52,52c0,17.9-9.5,34.7-24.5,44.1l-5.6-12
			C287.6,92,294,80,294,67.1c0-21.4-17.4-38.9-38.9-38.9c-21.4,0-38.9,17.4-38.9,38.9c0,14.9,8.3,28.2,21.6,34.8
			c0.9,0.5,1.9,0.7,2.9,0.7c2.4,0,4.6-1.3,5.8-3.6c1.6-3.2,0.3-7-2.9-8.6c-8.9-4.4-14.5-13.4-14.5-23.3c0-14.3,11.7-26,26-26
			c14.3,0,26,11.7,26,26c0,7.9-3.6,15.3-9.6,20.2L261,64.4c-1.5-3.2-5.3-4.6-8.5-3.1c-3.2,1.5-4.6,5.3-3.1,8.5l33.9,73.2
			c1.1,2.3,3.4,3.7,5.8,3.7c0.9,0,1.8-0.2,2.7-0.6c3.2-1.5,4.6-5.3,3.1-8.5l-6.8-14.7C307.6,111.4,320,90,320,67.1z"></path><path fill="#ABC45C" d="M220.1,133.9c-3.6,0-6.5,2.9-6.5,6.5c0,3.6,2.9,6.5,6.5,6.5c3.6,0,6.5-2.9,6.5-6.5
			C226.6,136.7,223.7,133.9,220.1,133.9z"></path></g><g><path fill="#fff" d="M40,164.1c-1.3-2.8-3.4-4.5-6.6-4.5h-0.5c-3.2,0-5.4,1.7-6.7,4.5L2.6,216.7c-0.5,0.9-0.7,1.7-0.7,2.5
			c0,2.9,2.3,5.2,5.2,5.2c2.4,0,4.3-1.3,5.2-3.5l5.4-12.2h30.8l5.2,11.9c1,2.4,2.8,3.9,5.4,3.9c3,0,5.3-2.4,5.3-5.4
			c0-0.7-0.2-1.5-0.6-2.4L40,164.1z M21.8,198.8L33,173.1l11.2,25.7H21.8z"></path><path fill="#fff" d="M113.4,175.5c-3,0-5.4,2.4-5.4,5.4v2.3c-3.7-4.4-8.7-8.2-16.8-8.2c-11.2,0-21.8,8.3-21.8,22.5v0.2
			c0,14.1,10.5,22.4,21.8,22.4c7.9,0,12.9-3.6,16.9-8.8v3.7c0,9.6-5.4,14.7-15.2,14.7c-5.5,0-10.3-1.4-14.7-3.8
			c-0.5-0.3-1.2-0.5-2-0.5c-2.5,0-4.6,2.1-4.6,4.5c0,2.1,1.2,3.6,3.1,4.4c5.8,2.8,11.8,4.3,18.5,4.3c8.6,0,15.3-2.1,19.7-6.4
			c4-4,6.1-10,6.1-18.1v-33.1C119,178,116.5,175.5,113.4,175.5z M108.2,197.7c0,7.8-6.4,13.2-14.1,13.2c-7.5,0-13.6-5.4-13.6-13.2
			v-0.2c0-7.9,6-13.2,13.6-13.2c7.6,0,14.1,5.4,14.1,13.2V197.7z"></path><path fill="#fff" d="M154,175.4c-4.8,0-9.5,4.5-12.1,10.5v-4.9c0-3.1-2.4-5.5-5.5-5.5c-3.1,0-5.4,2.4-5.4,5.5V219
			c0,3.1,2.5,5.4,5.4,5.4c3.1,0,5.5-2.4,5.5-5.4v-14.2c0-11.3,5.4-17.3,13.2-18.7c2.5-0.5,4.4-2.4,4.4-5.3
			C159.4,177.7,157.4,175.4,154,175.4z"></path><path fill="#fff" d="M187.9,175.1c-14.7,0-25.6,11.3-25.6,25v0.2c0,13.6,10.8,24.8,25.4,24.8c14.8,0,25.7-11.3,25.7-25v-0.2
			C213.4,186.2,202.6,175.1,187.9,175.1z M202.4,200.3c0,8.3-5.6,15.2-14.5,15.2c-8.5,0-14.6-7-14.6-15.3v-0.2
			c0-8.3,5.6-15.2,14.4-15.2c8.6,0,14.7,7,14.7,15.4V200.3z"></path><path fill="#fff" d="M248.7,175.1c-7.4,0-11.9,3.9-15,8.3v-2.4c0-3.1-2.4-5.5-5.5-5.5c-3.1,0-5.4,2.4-5.4,5.5V219
			c0,3.1,2.5,5.4,5.4,5.4c3.1,0,5.5-2.4,5.5-5.4v-22c0-7.4,4.4-11.9,10.8-11.9c6.5,0,10.3,4.3,10.3,11.7V219c0,3.1,2.5,5.4,5.5,5.4
			c3.1,0,5.4-2.4,5.4-5.4v-25.6C265.8,182.3,259.5,175.1,248.7,175.1z"></path><path fill="#fff" d="M300.2,175.1c-14.7,0-25.6,11.3-25.6,25v0.2c0,13.6,10.8,24.8,25.4,24.8c14.8,0,25.7-11.3,25.7-25v-0.2
			C325.7,186.2,314.9,175.1,300.2,175.1z M314.7,200.3c0,8.3-5.6,15.2-14.5,15.2c-8.5,0-14.6-7-14.6-15.3v-0.2
			c0-8.3,5.6-15.2,14.4-15.2c8.6,0,14.7,7,14.7,15.4V200.3z"></path><path fill="#fff" d="M391.1,175.1c-7.3,0-12.3,3.4-16.2,8.4c-2.5-5.1-7.4-8.4-14.3-8.4c-7.4,0-11.5,4-14.6,8.3v-2.3
			c0-3.1-2.4-5.5-5.5-5.5s-5.4,2.4-5.4,5.5V219c0,3.1,2.5,5.4,5.4,5.4c3.1,0,5.5-2.4,5.5-5.4v-22c0-7.3,4.2-11.9,10.3-11.9
			c6.1,0,9.7,4.2,9.7,11.6V219c0,3.1,2.4,5.4,5.5,5.4c3,0,5.4-2.4,5.4-5.4v-22c0-7.7,4.3-11.9,10.3-11.9c6.2,0,9.7,4.1,9.7,11.7V219
			c0,3.1,2.4,5.4,5.5,5.4c3.1,0,5.4-2.4,5.4-5.4v-25.6C407.9,181.7,401.5,175.1,391.1,175.1z"></path><path fill="#fff" d="M425.5,157.8c-3.5,0-6.3,2.1-6.3,5.4v0.5c0,3.3,2.7,5.4,6.3,5.4c3.5,0,6.3-2.2,6.3-5.4v-0.5
			C431.7,159.9,429,157.8,425.5,157.8z"></path><path fill="#fff" d="M425.5,175.5c-3.1,0-5.4,2.4-5.4,5.5V219c0,3.1,2.4,5.4,5.4,5.4c3.1,0,5.5-2.4,5.5-5.4v-37.9
			C431,178,428.5,175.5,425.5,175.5z"></path><path fill="#fff" d="M475.3,159.4c-19.5,0-33.3,15-33.3,32.8v0.2c0,17.9,13.6,32.7,33.1,32.7c3.3,0,6.4-0.5,9.3-1.3l1.7,3.6
			c0.9,1.9,2.8,3,4.8,3c0.8,0,1.5-0.2,2.2-0.5c2.6-1.2,3.8-4.4,2.5-7l-1.6-3.5c8.9-5.9,14.3-16,14.3-27.3V192
			C508.4,174.2,494.8,159.4,475.3,159.4z M496.7,192.4c0,6.9-2.7,13-7.3,17.1l-2-4.2c-1.2-2.6-4.4-3.8-7-2.5c-2.6,1.2-3.8,4.4-2.5,7
			l2.1,4.4c-1.5,0.3-3,0.5-4.6,0.5c-12.6,0-21.6-10.2-21.6-22.5V192c0-12.3,8.8-22.4,21.4-22.4s21.6,10.3,21.6,22.6V192.4z"></path></g></g></svg>
      </div>
  <br>
</p>
 
Repositório contendo as instruções do processo seletivo para Desenvolvedor Backend na AgronomiQ.

# Descrição e objetivos

Este teste foi criado para avaliar suas habilidades no desenvolvimento de uma aplicação backend que integre funcionalidades geoespaciais. O objetivo é criar uma API que interaja com um banco de dados PostgreSQL com a extensão PostGIS, fornecendo endpoints para manipulação e consulta de dados geoespaciais.

Seus objetivos são:

1. Instalar e Configurar PostGIS no PostgreSQL:

    - Instale a extensão PostGIS no PostgreSQL.
    - Configure o ambiente PostgreSQL com PostGIS nas migrations do Laravel. Isto deve ser feito para preparar o banco de dados para operações geoespaciais.


2. Criar Tabelas de Feições Geoespaciais:

    - Tabela `municipios_geometria`: Para armazenar as geometrias dos municípios de SP e MG. Os municípios devem ser criados a partir dos GeoJSONs fornecidos. Esta tabela deve possuir os campos "id", "nome_municipio" e "geom".
    - Tabela `estados_geometria`: Para armazenar as geometrias dos estados de São Paulo (SP) e Minas Gerais (MG). Esta tabela deve ser criada processando os dados dos municípios de cada estado e realizando um join/dissolve para formar a geometria do estado. Esta tabela deve possuir os campos "id", "nome_estado" e "geom".
    - Crie as tabelas estados_geometria e municipios_geometria utilizando os geojson dos [municípios de São Paulo](https://raw.githubusercontent.com/tbrugz/geodata-br/master/geojson/geojs-35-mun.json) e o geojson dos [municípios de Minas Gerais](https://raw.githubusercontent.com/tbrugz/geodata-br/master/geojson/geojs-31-mun.json) como insumos.
    - Tabela `pontos_usuario`: Para armazenar os pontos postados pelos usuários, com campos para "id", "latitude", "longitude", "municipio_id" e "geom".
    - PS: As colunas de geometrias das tabelas criadas devem ser do tipo Geometry e devem ter o nome "geom" e devem estar no SRID 4326.


3. Desenvolver Endpoints Específicos:

    - Consulta por Latitude e Longitude (`/api/localizar-municipio`): Endpoint para receber latitude e longitude e retornar o município correspondente ou erro se não encontrado.
    - CRUD de Pontos (`/api/pontos`): Implemente um CRUD completo para manipular a tabela pontos_usuario, com os métodos POST, GET, PUT, DELETE.

# Avaliação
## Lista de tarefas a serem cumpridas
- [ ] Instalar e Configurar PostGIS no PostgreSQL via migrations do Laravel

- [ ] Criar Tabela `estados_geometria`

- [ ] Criar Tabela `municipios_geometria`

- [ ] Criar Tabela `pontos_usuario`

- [ ] Consulta por Latitude e Longitude (`/api/localizar-municipio`)

- [ ] CRUD de Pontos (`/api/pontos`)

- [ ] Criar um README.md com instruções adicionais de instalação e configuração do projeto

- [ ] Enviar o link do repositório para o e-mail


## Critérios avaliados
* Cumprimento da lista de tarefas;
* Qualidade do Código: Limpeza, eficiência e organização.
* Git: Boas práticas;
* Facilidade de manutenção e extensão das novas funções implementadas;
* Processamento de Dados: Eficácia no manuseio e análise de dados geoespaciais.
* Visualização: Clareza, interatividade e estética da visualização de dados.
* Laravel: Utilização de recursos do framework para facilitar o desenvolvimento.

# Dicas
* Use o estilo de código mais confortável à você;
* Os nomes de variáveis e comentários no código podem ser feitos em português ou inglês;
* Se o código submetido demandar instalações de quaisquer natureza, espera-se que hajam instruções de instalação no README;
* Neste teste não há pegadinhas ou detalhes escondidos, então não se preocupe em tentar procurá-los.

# Submissão
* Faça uma cópia do repositório, torne-o privado e adicione o usuário **@cgromulo**, **@rmfleitao**, **@lucashenris** e **@abreufilho** como colaborador usando o link abaixo:
  * >https://github.com/SEU_USUARIO/aq-backend-dev/settings/access
* Faça as alterações de modo a cumprir as tarefas deste teste, dê os commits necessários e o push final para o seu repositório remoto no GitHub, lembrando de fazê-lo antes do prazo final.
* O tempo de entrega *NÃO* está sendo avaliado, mas envios após a data e hora limite serão desconsiderados.
* Nenhum código desenvolvido neste teste será utilizado em produção/comercialmente pela AgronomiQ.
* Não adicione requerimentos de configuração de ambiente ou instalações via Docker, parte do teste é que ele funcione na versão 9 do Laravel e com PHP <= 8.1.
* Ao concluir o teste, envie um e-mail para romulo.leitao@agronomiq.com.br com cópia (CC) para rodrigo.leitao@agronomiq.com.br e antonio.abreu@agronomiq.com.br contendo somente o link para seu repositório no corpo do texto e o título do e-mail com as seguintes especificações ex.:
  >De: **seu_nome@email.com**

  >Para: **romulo.leitao@agronomiq.com.br**

  >Título: **Teste Backend - [Seu Nome]**

  >Corpo do e-mail: **https://github.com/{SEU_USUARIO}/aq-backend-dev**
   
# Instruções de instalação/configuração

Faça um clone deste repositório.

Instale as dependências do projeto:

```
composer install
npm install
```

Depois copie o arquivo `.env.example` para `.env`:

Crie um banco de dados temporário para a aplicação com o comando abaixo:
    
```
sudo -u postgres psql -c "CREATE DATABASE agronomiq_teste"
```

Depois, gere a chave da aplicação:

```
php artisan key:generate
```

Rode a migração para criar as tabelas no banco de dados:

```
php artisan migrate
```

E por fim, inicie o servidor local da Aplicação:

```
php artisan serve
```

Acesse a aplicação em http://localhost:8000.

Este repositório utiliza Laravel 9. Consulte a documentação oficial para mais informações.

---

# 🎯 Funcionalidades Implementadas

Este projeto foi estendido com funcionalidades de visualização de dados geoespaciais e gráficos interativos.

## 📋 Lista de Funcionalidades

### ✅ 1. Página Inicial com Navegação
- **Rota:** `/`
- **Descrição:** Página inicial com dois cartões de navegação:
  - **Mapa:** Leva para a visualização do mapa interativo
  - **Gráfico:** Leva para a visualização de gráficos de dados climáticos
- **Tecnologias:** Laravel Blade, TailwindCSS

### ✅ 2. Página do Mapa Interativo
- **Rota:** `/mapa`
- **Descrição:** Mapa interativo com OpenLayers contendo:

#### Funcionalidades do Mapa:
1. **Componente de Coordenadas do Mouse**
   - Posição: Canto inferior esquerdo (fixo)
   - Estilo: Fundo branco com opacidade 0.5, fonte 18px
   - Exibe latitude e longitude em tempo real

2. **Context Menu (Popup)**
   - Ativação: Clique com botão direito no mapa
   - Conteúdo:
     - Latitude e longitude do ponto clicado
     - Data/hora do clique (formato: DD/MM/YYYY HH:mm:ss)
     - Ícone de calendário ao lado da data
   - Espaçamento maior entre elementos (padding 20px, margin 12px)

3. **Botões de Zoom**
   - Posição: Topo esquerdo (flutuantes)
   - Botão Zoom In (+): Aumenta o zoom do mapa
   - Botão Zoom Out (-): Diminui o zoom do mapa
   - Ícones: Font Awesome

4. **Botão de Alternar Mapa de Fundo**
   - Posição: Topo direito
   - Funcionalidade: Alterna entre:
     - OpenStreetMap (mapa de ruas)
     - Google Satellite (imagem de satélite)
   - Indicador visual do mapa ativo

5. **Barra de Escala**
   - Posição: Canto inferior direito
   - Exibe a escala do mapa em metros/quilômetros

- **Tecnologias:** OpenLayers 8.2.0, Font Awesome 6.4.0

### ✅ 3. Página de Gráficos
- **Rota:** `/grafico`
- **Descrição:** Visualização de dados climáticos com Chart.js

#### Funcionalidades do Gráfico:
1. **Datasets**
   - **Temperatura:** Gráfico de linhas (vermelho)
   - **Precipitação:** Gráfico de barras (azul)
   - Dados mensais (12 meses)

2. **Botão de Alternar Visualização**
   - **Ambos:** Exibe temperatura e precipitação juntos
   - **Temperatura:** Exibe apenas temperatura
   - **Precipitação:** Exibe apenas precipitação
   - Indicador visual do modo ativo

3. **Características do Gráfico**
   - Dois eixos Y (temperatura à esquerda, precipitação à direita)
   - Tooltip interativo ao passar o mouse
   - Legenda customizada
   - Animações suaves
   - Design responsivo

- **Tecnologias:** Chart.js 4.4.0, Font Awesome 6.4.0

### ✅ 4. Navegação Contínua
- Todas as páginas possuem botões de navegação para:
  - Voltar à página inicial
  - Ir para o mapa
  - Ir para o gráfico
- Não é necessário voltar à página inicial para navegar entre seções

### ✅ 5. Estilização com app.css
- Arquivo `resources/css/app.css` contém:
  - Estilos globais reutilizáveis
  - Classes utilitárias (spacing, flexbox, cores)
  - Componentes de botões e cards
  - Animações
  - Responsividade

### ✅ 6. Documentação do Código
- Todas as funções JavaScript possuem docstrings
- Comentários explicativos em código novo
- Documentação inline para facilitar manutenção

### ✅ 7. Testes E2E com Cypress
- Suite completa de testes automatizados
- Cobertura de todas as funcionalidades implementadas

---

## 🧪 Executando os Testes

### Pré-requisitos
Certifique-se de que o servidor Laravel está rodando:
```bash
php artisan serve
```

### Instalar Cypress
Se ainda não instalou as dependências do npm:
```bash
npm install
```

### Executar Testes

**Modo Interativo (recomendado para desenvolvimento):**
```bash
npm run cypress:open
```

**Modo Headless (para CI/CD):**
```bash
npm run cypress:run
```

### Estrutura dos Testes
```
cypress/
├── e2e/
│   ├── home.cy.js       # Testes da página inicial
│   ├── mapa.cy.js       # Testes do mapa interativo
│   └── grafico.cy.js    # Testes dos gráficos
├── support/
│   ├── commands.js      # Comandos customizados
│   └── e2e.js          # Configurações globais
└── cypress.config.js    # Configuração do Cypress
```

### Cobertura de Testes

#### Página Inicial (home.cy.js)
- ✅ Carregamento da página
- ✅ Exibição dos cartões
- ✅ Navegação para mapa e gráfico
- ✅ Efeitos hover

#### Página do Mapa (mapa.cy.js)
- ✅ Carregamento do mapa
- ✅ Componente de coordenadas do mouse
- ✅ Context menu (popup) com data/hora
- ✅ Botões de zoom in/out
- ✅ Alternar mapa de fundo
- ✅ Navegação contínua
- ✅ Barra de escala

#### Página de Gráficos (grafico.cy.js)
- ✅ Carregamento do Chart.js
- ✅ Datasets de temperatura e precipitação
- ✅ Botões de alternar visualização
- ✅ Tipos de gráfico (linha e barras)
- ✅ Legenda customizada
- ✅ Navegação contínua
- ✅ Responsividade

---

## 🛠️ Tecnologias Utilizadas

### Backend
- **Laravel 9.x** - Framework PHP
- **PHP 8.0+** - Linguagem de programação

### Frontend
- **OpenLayers 8.2.0** - Biblioteca de mapas interativos
- **Chart.js 4.4.0** - Biblioteca de gráficos
- **Font Awesome 6.4.0** - Ícones
- **TailwindCSS** - Framework CSS (inline)

### Testes
- **Cypress 13.6.0** - Framework de testes E2E

### Ferramentas
- **Vite** - Build tool
- **Composer** - Gerenciador de dependências PHP
- **NPM** - Gerenciador de dependências JavaScript

---

## 📁 Estrutura do Projeto

```
aq-backend-dev/
├── app/                          # Código da aplicação Laravel
├── resources/
│   ├── views/
│   │   ├── welcome.blade.php    # Página inicial
│   │   ├── mapa.blade.php       # Página do mapa
│   │   └── grafico.blade.php    # Página de gráficos
│   └── css/
│       └── app.css              # Estilos customizados
├── routes/
│   └── web.php                  # Rotas da aplicação
├── cypress/
│   ├── e2e/                     # Testes E2E
│   └── support/                 # Suporte do Cypress
├── public/                      # Arquivos públicos
├── cypress.config.js            # Configuração do Cypress
├── package.json                 # Dependências JavaScript
├── composer.json                # Dependências PHP
└── README.md                    # Este arquivo
```

---

## 🎨 Boas Práticas Implementadas

### Código
- ✅ Funções documentadas com docstrings
- ✅ Comentários explicativos em código novo
- ✅ Nomenclatura clara e descritiva
- ✅ Separação de responsabilidades
- ✅ Código modular e reutilizável

### UI/UX
- ✅ Design responsivo
- ✅ Feedback visual em interações
- ✅ Navegação intuitiva
- ✅ Cores e ícones consistentes
- ✅ Animações suaves
- ✅ Acessibilidade

### Testes
- ✅ Cobertura completa de funcionalidades
- ✅ Testes organizados por página
- ✅ Comandos customizados reutilizáveis
- ✅ Asserções claras e específicas

### Git
- ✅ Commits descritivos
- ✅ Mensagens claras e objetivas
- ✅ Histórico organizado

---

## 📝 Notas Importantes

1. **Servidor Local:** A aplicação deve estar rodando em `http://localhost:8000` para os testes funcionarem
2. **Dependências:** Execute `composer install` e `npm install` antes de rodar a aplicação
3. **Navegadores:** Os testes Cypress funcionam em Chrome, Firefox e Edge
4. **Dados do Gráfico:** Os dados de temperatura e precipitação são mockados para demonstração

---

## 🚀 Próximos Passos (Opcional)

- [ ] Integrar com API real de dados climáticos
- [ ] Adicionar mais camadas ao mapa (municípios, estados)
- [ ] Implementar filtros de data nos gráficos
- [ ] Adicionar exportação de gráficos (PNG, PDF)
- [ ] Implementar autenticação de usuários
- [ ] Deploy em produção

---

## 📞 Suporte

Para dúvidas ou problemas, consulte a documentação oficial:
- [Laravel 9](https://laravel.com/docs/9.x)
- [OpenLayers](https://openlayers.org/)
- [Chart.js](https://www.chartjs.org/)
- [Cypress](https://docs.cypress.io/)

---

**Desenvolvido com ❤️ para AgronomiQ**
